var __reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},game;!function(t){var e=function(){function e(e){this._interval=0,this._targetSpeed=0,this._lastIntervalIndex=0,this._target=e,this._speedRang=[],this._accTimedRang=[],this._count=0,t.DataEventDispatcher.addEventListener(t.GameEventType.STATUS_CHANGE,this.onGameStatusChange,this)}return e.prototype.onGameStatusChange=function(e){var a=t.GameGlobal.status;a==t.Status.start&&(this._target.speed=this._startSpeed,this.setSpeedInterval())},e.prototype.reset=function(){this._count=this._targetSpeed=this._lastIntervalIndex=this._interval=this._lastTargetSpeed=0},e.prototype.setConfig=function(t){this._accelerate=t.accelerate,this._startSpeed=t.startSpeed,this.formatRang(t.speed,this._speedRang),this.formatRang(t.durationTime,this._accTimedRang),this.reset()},e.prototype.setCamera=function(t){this._camera=t},Object.defineProperty(e.prototype,"targetSpeed",{get:function(){return this._targetSpeed},set:function(t){this._targetSpeed=t},enumerable:!0,configurable:!0}),e.prototype.onLoop=function(){if(this.isRunState){var e=t.GameGlobal.status;e==t.Status.free?(this._target.speed==this._targetSpeed&&(++this._count,this._count>=this._interval&&(this._count=0,this.setSpeedInterval(this._target.rank<5?0:-1))),2!=this._lastIntervalIndex&&Math.abs(this._camera.x-this._target.x)>this._camera.width-130&&this.setSpeedInterval(2)):e==t.Status.sprint&&(this._target.rank>this.targetResultRank?this._targetSpeed=this._speedRang[1][1]:this._target.rank<this.targetResultRank?this._targetSpeed=this._speedRang[0][0]:this._targetSpeed=this._speedRang[0][1]-1.3*this._target.rank),this.accelerate(),this.decelerate(),0!=this._lastTargetSpeed&&this._targetSpeed>this._lastTargetSpeed&&e!=t.Status.start?this._target.status=t.UnitStatus.accelerate:this._target.status=t.UnitStatus.move}},Object.defineProperty(e.prototype,"isRunState",{get:function(){var e=t.GameGlobal.status;return e==t.Status.start||e==t.Status.free||e==t.Status.sprint||e==t.Status.finish},enumerable:!0,configurable:!0}),e.prototype.accelerate=function(){this._target.speed>=this._targetSpeed||(this._target.speed+=this._accelerate,this._target.speed>this._targetSpeed&&(this._target.speed=this._targetSpeed))},e.prototype.decelerate=function(){this._target.speed<=this._targetSpeed||(this._target.status=t.UnitStatus.move,this._target.speed-=this._accelerate,this._target.speed<this._targetSpeed&&(this._target.speed=this._targetSpeed))},e.prototype.setSpeedInterval=function(e){void 0===e&&(e=-1),e==-1&&(e=Math.random()>=.5?1:0),this._count=0,this._lastIntervalIndex=e;var a=this._accTimedRang[e],s=a[0],r=a[1];this._interval=(Math.random()*(r-s)+s)*t.LoopManager.realFrameRate,a=this._speedRang[e],s=a[0],r=a[1],this._lastTargetSpeed=this._targetSpeed,this._targetSpeed=Math.random()*(r-s)+s>>0},e.prototype.formatRang=function(t,e){for(var a,s,r=t.split("_"),i=0;i<r.length;)a=[],s=r[i].split("-"),a[0]=parseInt(s[0]),a[1]=parseInt(s[1]),e.push(a),++i},e}();t.AI=e,__reflect(e.prototype,"game.AI")}(game||(game={}));